{% extends "base.html" %} {% load static %} {% block title %} Hızlı Alışveriş {% endblock title %} {% block content %}


<div class="bread_crumb_1ugPk">

    <div class="secwraptop">

        <div class="stepOne">Teslimat</div>
        <div class="stepTwo">Ödeme</div>
        <p>
        </p>
        <div class="stepThree">
            <div></div>
            <span>
            Hızlı Alışveriş
        </span>
        </div>
    </div>

    {% if request.user.is_authenticated %} {% for item in items|slice:"0:1" %}
    <div class="userftg">
        {{item.order.customerHead}}
    </div>
    {% endfor %} {% endif %}


</div>



<div id="employee">

    <section>
        <div class="AddressEmp">

            <h4>Teslimat adresi </h4>

            {% if addresses %}

            <a class="addAddressLink">
                <svg class="mr-2" width="17" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="64" height="64" viewBox="0 0 172 172" style=" fill:#000000;"><g fill="none" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><path d="M0,172v-172h172v172z" fill="none"></path><g fill="#ff6000"><path d="M86,8.13074c-19.95469,0 -39.90938,7.59114 -55.09375,22.77551c-30.36875,30.36875 -30.36875,79.81875 0,110.1875c15.18437,15.18437 35.20625,22.84375 55.09375,22.84375c19.8875,0 39.90937,-7.65938 55.09375,-22.84375c30.36875,-30.36875 30.36875,-79.81875 0,-110.1875c-15.18438,-15.18437 -35.13906,-22.77551 -55.09375,-22.77551zM86,16.125c17.87188,0 35.7448,6.85208 49.45105,20.42395c27.14375,27.27812 27.14375,71.62397 0,98.9021c-27.27812,27.27812 -71.62187,27.27812 -98.76562,0c-27.27812,-27.27812 -27.28022,-71.62397 -0.13647,-98.9021c13.70625,-13.57187 31.57917,-20.42395 49.45105,-20.42395zM86,56.4375c-2.28437,0 -4.03125,1.74687 -4.03125,4.03125v21.5h-21.5c-2.28438,0 -4.03125,1.74688 -4.03125,4.03125c0,2.28437 1.74687,4.03125 4.03125,4.03125h21.5v21.5c0,2.28437 1.74688,4.03125 4.03125,4.03125c2.28437,0 4.03125,-1.74688 4.03125,-4.03125v-21.5h21.5c2.28437,0 4.03125,-1.74688 4.03125,-4.03125c0,-2.28437 -1.74688,-4.03125 -4.03125,-4.03125h-21.5v-21.5c0,-2.28438 -1.74688,-4.03125 -4.03125,-4.03125z"></path></g></g></svg>
                <span>
                    Yeni adres ekle
                </span>
            </a>


            <div class="addresWrap">

                {% for addres in addresses %}

                <div class="addres" data-id="{{addres.id}}">
                    <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="26" height="26" viewBox="0 0 172 172" style=" fill:#000000;"><g fill="none" fill-rule="nonzero" stroke="none" stroke-width="none" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><path d="M0,172v-172h172v172z" fill="none" stroke="none" stroke-width="1"></path><g><path d="M22.93333,157.66667c-4.74147,0 -8.6,-3.85853 -8.6,-8.6v-126.13333c0,-4.74147 3.85853,-8.6 8.6,-8.6h126.13333c4.74147,0 8.6,3.85853 8.6,8.6v126.13333c0,4.74147 -3.85853,8.6 -8.6,8.6z" fill="#6c84fa" stroke="none" stroke-width="1"></path><path d="M149.06667,17.2c3.15907,0 5.73333,2.57427 5.73333,5.73333v126.13333c0,3.15907 -2.57427,5.73333 -5.73333,5.73333h-126.13333c-3.15907,0 -5.73333,-2.57427 -5.73333,-5.73333v-126.13333c0,-3.15907 2.57427,-5.73333 5.73333,-5.73333h126.13333M149.06667,11.46667h-126.13333c-6.33533,0 -11.46667,5.13133 -11.46667,11.46667v126.13333c0,6.33533 5.13133,11.46667 11.46667,11.46667h126.13333c6.33533,0 11.46667,-5.13133 11.46667,-11.46667v-126.13333c0,-6.33533 -5.13133,-11.46667 -11.46667,-11.46667z" fill="#6c84fa" stroke="none" stroke-width="1"></path><path d="M48.73333,86.21787l24.6992,24.6992l55.56747,-55.56747" fill="none" stroke="#ffffff" stroke-width="11.46667"></path></g></g></svg>
                    <b>
                        {{addres.title}}

                    </b>

                    <div>
                        {{addres.address|truncatechars:65}}

                    </div>
                    <span>
                        {{addres.state|upper}} / {{addres.city}}

                    </span>




                </div>

                {% endfor %}

            </div>

            {% else %}
            <div class="noaddressEmp">

                <a class="addAddressLink">
                    <svg class="mr-2" width="17" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="64" height="64" viewBox="0 0 172 172" style=" fill:#000000;"><g fill="none" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><path d="M0,172v-172h172v172z" fill="none"></path><g fill="#ff6000"><path d="M86,8.13074c-19.95469,0 -39.90938,7.59114 -55.09375,22.77551c-30.36875,30.36875 -30.36875,79.81875 0,110.1875c15.18437,15.18437 35.20625,22.84375 55.09375,22.84375c19.8875,0 39.90937,-7.65938 55.09375,-22.84375c30.36875,-30.36875 30.36875,-79.81875 0,-110.1875c-15.18438,-15.18437 -35.13906,-22.77551 -55.09375,-22.77551zM86,16.125c17.87188,0 35.7448,6.85208 49.45105,20.42395c27.14375,27.27812 27.14375,71.62397 0,98.9021c-27.27812,27.27812 -71.62187,27.27812 -98.76562,0c-27.27812,-27.27812 -27.28022,-71.62397 -0.13647,-98.9021c13.70625,-13.57187 31.57917,-20.42395 49.45105,-20.42395zM86,56.4375c-2.28437,0 -4.03125,1.74687 -4.03125,4.03125v21.5h-21.5c-2.28438,0 -4.03125,1.74688 -4.03125,4.03125c0,2.28437 1.74687,4.03125 4.03125,4.03125h21.5v21.5c0,2.28437 1.74688,4.03125 4.03125,4.03125c2.28437,0 4.03125,-1.74688 4.03125,-4.03125v-21.5h21.5c2.28437,0 4.03125,-1.74688 4.03125,-4.03125c0,-2.28437 -1.74688,-4.03125 -4.03125,-4.03125h-21.5v-21.5c0,-2.28438 -1.74688,-4.03125 -4.03125,-4.03125z"></path></g></g></svg>
                    <span>
                    Yeni adres ekle
                </span>
                </a>

            </div>

            {% endif %}


        </div>


        <div class="OrderSummaryEmp">

            <h4>
                Teslimat seçenekleri
            </h4>
            <div class="item_wrapper">


                {% for item in items %}


                <div id="item">
                    <div class="item_seller">
                        <b class="mr-1">
                            {{item.product.brand|title}} 

                        </b> tarafından gönderilecek ürünler


                    </div>

                    <div class="pro2fssc">


                        <div class="sec1">
                            <div class="item_img">

                                {% if item.quantity > 1 %}
                                <div class="item_quantity">
                                    x {{item.quantity}}
                                </div>
                                {% endif %}



                                <img width="86" src="{{item.product.image.url}}" alt="{{item.product.title}}">
                            </div>
                            <div class="item_info">

                                <div class="item_title">
                                    {{item.product.title}}
                                </div>


                                <div class="scfr5">


                                    {% if item.chooseSize%}
                                    <div class="chooseSize">

                                        {{item.chooseSize}}

                                    </div>

                                    {% endif %} {% if item.chooseColor and item.chooseSize %}
                                    <b> / </b> {% endif %} {% if item.chooseColor %}

                                    <div class="chooseColor">
                                        {{item.chooseColor}}

                                    </div>

                                    {% endif %}



                                    <span class="s_m676">
                                        
                                        Kargoya veriliş tarihi : 
                                        <a>

                                            {{item.product.cargotime}} 

                                        </a>

    
                                    </span>


                                </div>


                            </div>



                        </div>

                        <div class="sec2">

                            <div class="piece_one">
                                <svg class="mr-2 mt-1" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="21" height="21" viewBox="0 0 172 172" style=" fill:#000000;"><g transform=""><g fill="none" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><path d="M0,172v-172h172v172z" fill="none"></path><path d="" fill="none"></path><g><path d="M86,166.625c-44.505,0 -80.625,-36.12 -80.625,-80.625c0,-44.505 36.12,-80.625 80.625,-80.625c44.505,0 80.625,36.12 80.625,80.625c0,44.505 -36.12,80.625 -80.625,80.625z" fill="#ff6000"></path><path d="M86,6.45c43.86,0 79.55,35.69 79.55,79.55c0,43.86 -35.69,79.55 -79.55,79.55c-43.86,0 -79.55,-35.69 -79.55,-79.55c0,-43.86 35.69,-79.55 79.55,-79.55M86,4.3c-45.15,0 -81.7,36.55 -81.7,81.7c0,45.15 36.55,81.7 81.7,81.7c45.15,0 81.7,-36.55 81.7,-81.7c0,-45.15 -36.55,-81.7 -81.7,-81.7z" fill="#ff6000"></path><path d="M73.1,120.4l-29.67,-29.67l9.245,-9.03l20.425,20.64l52.03,-52.03l9.245,9.03z" fill="#ffffff"></path></g></g></g></svg>

                                <div>
                                    <h5>
                                        Standart Teslimat
                                        <svg class="ml-2  " xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="16" height="16" viewBox="0 0 172 172" style=" fill:#000000;"><g fill="none" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><path d="M0,172v-172h172v172z" fill="none"></path><g fill="#afafaf"><path d="M86,17.2c-37.9948,0 -68.8,30.8052 -68.8,68.8c0,37.9948 30.8052,68.8 68.8,68.8c37.9948,0 68.8,-30.8052 68.8,-68.8c0,-37.9948 -30.8052,-68.8 -68.8,-68.8zM91.73333,120.4h-11.46667v-40.13333h11.46667zM86,65.93333c-4.7472,0 -8.6,-3.8528 -8.6,-8.6c0,-4.7472 3.8528,-8.6 8.6,-8.6c4.7472,0 8.6,3.8528 8.6,8.6c0,4.7472 -3.8528,8.6 -8.6,8.6z"></path></g></g></svg>
                                    </h5>

                                    <p>
                                        Tahmini Teslim :

                                        <a>

                                            {{item.product.forwardcargotime}}

                                        </a>
                                    </p>
                                </div>
                            </div>

                            <div class="cargoXs">
                                Kargo bedava
                            </div>

                        </div>

                    </div>






                </div>
                {% endfor %}


            </div>



        </div>


        <!-- ÖDEME KISMI -->
        <br><br><br>

        <div class=" Payment_Area" id="payment-info">
            <h4>Ödeme seçenekleri </h4>
            <button id="make-payment">Ödeme Yap [ deneme ]  </button>
            <br>
            <div id="paypal-container-btn">
            </div>
        </div>

        <small class="text-danger uyarı">Ödeme işlemine geçebilmek için Ön bilgilendirme formunu ve Mesafeli satış sözleşmesini onaylamalısınız.</small>


        <div class="payment_received" style="display: none;">
            <p><img src="https://img.icons8.com/clouds/100/000000/checked--v1.png" /> Ödeme Başarıyla Alındı .
            </p>

            <span>Siparişi onayla tuşuna basıp siparişi bitirebilirsiniz.</span>

        </div>



    </section>

    <section>
        <div class="payed_prices_Emp">
            <h4>ÖDENECEK TUTAR </h4>
            <h5 class="item_total">
                {{order.get_cart_total}} <small>   TL  </small>
            </h5>

            <div class="contractCheck">

                <input type="checkbox">

                <div>
                    <a href="#">
                        Ön bilgilendirme formunu
                    </a> ve
                    <a href="#">

                        Mesafeli satış sözleşmesini

                     </a> onaylıyorum
                </div>

            </div>

            <button type="button" class="orderConfirmBtn" disabled>
                Siparişi onayla 
            </button>
            <p>
                Siparişi onayla butonuna bastığınızda toplam tutar tarafınızdan tahsil edilecektir.
            </p>


            <ul>
                <li>
                    <span>Kargo</span>
                    <div>
                        <span style="color:rgb(7, 187, 7)">Bedava</span>
                        <s>
                            412,99 TL
                        </s>
                    </div>
                </li>
                <li>
                    <span>Ürünler</span>
                    <b>{{order.get_cart_total}}  <small>TL</small></b>
                </li>

            </ul>



        </div>
    </section>





</div>




<div class="sideBar">

    <div class="close_side">
        <img src="https://img.icons8.com/windows/32/000000/multiply.png">
    </div>
    <form method="POST">
        {% csrf_token %}

        <h3>Adres Ekle </h3>

        <span>
            <div>
                01 Kişisel Bilgileriniz  
            </div>
        </span>


        <h6>Teslim alacak kişinin bilgileri</h6>
        {{form}}


        <button type="submit" class="saveBtn" data-process="add">Adresi Kaydet </button>
        <button type="button" class="giveupBtn">Vazgeç </button>

    </form>

</div>




{% endblock content %} {% block script %}

<script>
    $("#User-options").html(
        $(".bread_crumb_1ugPk")
    )
</script>





<script src="https://www.paypal.com/sdk/js?client-id=test&currency=USD"></script>
<script>
    var totall = '{{order.get_cart_total}}'
    paypal.Buttons({
        style: {
            color: 'blue',
            shape: 'rect',

        },
        // Set up the transaction
        createOrder: function(data, actions) {
            return actions.order.create({
                purchase_units: [{
                    amount: {
                        value: parseFloat(totall).toFixed(2)
                    }
                }]
            });
        },
        // Finalize the transaction
        onApprove: function(data, actions) {
            return actions.order.capture().then(function(details) {
                // Show a success message to the buyer
                alert('ÖDEME İŞLEMİ BASARIYLA GERÇEKLEŞTİ  ' + details.payer.name.given_name + '!');
                sendData()
                cart = {}
                document.cookie = 'cart=' + JSON.stringify(cart) + ';doamin=;path=/'

            });
        }

    }).render('#paypal-container-btn');
</script>

<script>
    var user = '{{request.user}}'

    var make_payment_Btn = $('.orderConfirmBtn')

    var total = '{{order.get_cart_total|floatformat:2}}'

    var shipping = '{{order.shipping}}'


    make_payment_Btn.click(function() {

        sendData()
    })

    function sendData() {

        chooseAddres = $(".addresWrap .addres.checked")[0]
        chooseAddresId = $(chooseAddres).data("id")


        var url = '/store/process_order/'

        fetch(url, {

                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': csrftoken,
                },
                body: JSON.stringify({
                    'chooseAddresId': chooseAddresId,
                    'total': total
                })


            }).then((response) => response.json())
            .then((data) => {


                cart = {}

                document.cookie = 'cart=' + JSON.stringify(cart) + ';domain=;path=/'

                window.location.href = "{% url 'home' %}"

            })





    }
</script>


<script src="/static/js/checkout.js"></script>

<script src="{% static 'js/addresses.js' %}"></script>


{% endblock script %} {% block css %}


<link rel="stylesheet" href="{% static 'css/checkout.css'  %}">


<link rel="stylesheet" href="{% static 'css/addresses.css'  %}"> {% endblock css %}